# diary_quest 🗡️📖

RPG風日記アプリケーション - 日常の日記を冒険日誌に変換しよう！

## 📖 概要

diary_questは、日常の日記をあらかじめ設定した世界観の旅の日記に自動変換するシステムです。
RPG要素とゲーミフィケーションにより、日記を書く習慣を楽しく継続できるようにします。

### 主な機能（MVP）

1. 🎯 **リアルライフクエストシステム** - 現実の目標をゲーム内クエストとして管理
2. 💭 **感情・メンタルヘルス分析** - AIによる感情分析と励まし機能
3. 🎲 **ランダムイベント** - 日記執筆時のサプライズ要素
4. 📖 **ストーリーモード** - 期間の日記を物語として再構成
5. 📊 **成長レポート** - 月次・年次レポート生成

## 🏗️ プロジェクト構成

```
diary_quest/
├── packages/           # 共有パッケージ
│   ├── core/           # 共通ビジネスロジック・ドメイン層
│   ├── database/       # DB抽象化・インフラ層
│   └── shared/         # 共有ユーティリティ・型定義
│
├── apps/
│   └── desktop/        # Phase 1: デスクトップアプリ（Tauri + React）
│
├── *.md                # 各種ドキュメント・設定サンプル
└── package.json        # Monorepo管理
```

## 🛠️ 技術スタック

### Phase 1: デスクトップアプリ

- **プラットフォーム**: Tauri 1.5+
- **フロントエンド**: React 18 + TypeScript
- **ビルドツール**: Vite
- **UI**: Tailwind CSS + shadcn/ui
- **状態管理**: Zustand
- **データベース**: SQLite (Running on `rusqlite` in production)
- **LLM API**: マルチプロバイダー対応 (OpenAI / Claude / Gemini)

### Monorepo管理

- **パッケージマネージャー**: pnpm
- **ビルドツール**: Turbo
- **言語**: TypeScript 5.0+
- **テストフレームワーク**: Vitest
- **リンター**: ESLint + Prettier

## セキュリティとプライバシー

当アプリケーションは「ユーザーのプライバシー第一」および「ローカルファースト」の原則に基づいて設計されています。

*   **完全オフライン指向**: アプリケーションの基本機能はオフラインで動作します。外部へのネットワーク通信は、ユーザーが明示的に設定・実行するLLM（AI）の生成リクエストのみに限定されています。
*   **データ所有権**: 日記データ、キャラクター設定、進捗状況などのすべてのデータは、ユーザーのローカルデバイス内（標準のアプリケーションデータフォルダ）にのみ保存されます。クラウドサーバーへの送信は行われません。
*   **安全な通信**: 外部LLMプロバイダー（OpenAI, Anthropic, Google）への通信は、暗号化されたHTTPS通信でのみ行われ、OSレベルで信頼されたドメインに制限されています（CSP設定済み）。

## 🚀 セットアップ

### 前提条件

- Node.js v18.0.0 以上
- pnpm v8.0.0 以上
- Rust 1.60 以上（Tauri用）

### Rustのインストール

Tauriアプリを実行するにはRustが必要です：

```bash
# Windows
# https://www.rust-lang.org/tools/install からインストーラーをダウンロード

# macOS / Linux
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# インストール確認
cargo --version
```

### インストール

```bash
# pnpmのインストール（まだの場合）
npm install -g pnpm

# 依存関係のインストール
pnpm install

# パッケージのビルド
pnpm build

# Tauriアプリの起動
cd apps/desktop
pnpm tauri:dev
```

### 開発コマンド

```bash
# すべてのパッケージをビルド
pnpm build

# 開発モード（ウォッチモード）
pnpm dev

# Tauriアプリの起動（デスクトップアプリ）
cd apps/desktop
pnpm tauri dev

# Tauriアプリのビルド（本番用）
cd apps/desktop
pnpm tauri build

# TypeScriptコンパイルチェック
pnpm tsc --noEmit

# テスト実行
pnpm test

# リント
pnpm lint

# フォーマット
pnpm format
```

## 📚 ドキュメント

詳細なドキュメントは以下を参照してください：

### プロジェクト管理
- [議事録_INDEX.md](./議事録_INDEX.md) - プロジェクト議事録の索引
- [開発環境セットアップ.md](./開発環境セットアップ.md) - 開発環境のセットアップガイド

### 設計ドキュメント
- [要件定義書.md](./要件定義書.md) - MVP機能の詳細仕様
- [技術選定書.md](./技術選定書.md) - 技術スタックの選定理由
- [設計書_データモデル.md](./設計書_データモデル.md) - データベーススキーマと型定義
- [設計書_コアロジックAPI.md](./設計書_コアロジックAPI.md) - ビジネスロジックのAPI設計
- [設計書_システムアーキテクチャ.md](./設計書_システムアーキテクチャ.md) - 全体アーキテクチャ

### サンプル
- [世界観設定サンプル_fantasy.md](./世界観設定サンプル_fantasy.md) - ファンタジー世界観のサンプル
- [キャラクターステータスサンプル.json](./キャラクターステータスサンプル.json) - RPGステータスのサンプル

## 📈 開発ロードマップ

### ✅ Phase 0: 設計フェーズ（完了）
- [x] アイデア出し
- [x] 要件定義
- [x] 技術選定
- [x] データモデル設計
- [x] コアロジックAPI設計
- [x] システムアーキテクチャ設計

### 🚧 Phase 1: デスクトップアプリ開発（完了目前）

**Sprint 1: 基盤構築（2週間）** ✅ 完了
- [x] プロジェクト初期化（Monorepo）
- [x] 開発環境セットアップ
- [x] LLMプロバイダー抽象化（LLMManager実装完了）
- [x] データベース抽象化（SQLite + AsyncDatabaseAdapter実装完了）

**Sprint 2: コア機能（3週間）** ✅ 完了
- [x] 日記変換エンジン（DiaryConverter実装完了）
- [x] キャラクター管理システム（CharacterRepository実装完了）
- [x] 基本的なクエスト機能（QuestRepository実装完了）
- [x] 世界観設定パーサー（基本構造実装完了）

**Sprint 3: UI実装（3週間）** ✅ 完了
- [x] ホーム画面
- [x] 日記執筆画面（DiaryPage完全実装）
- [x] キャラクター画面（詳細設定・マッピング機能実装済）
- [x] 設定画面（SettingsPage実装完了）

**Sprint 4: 高度な機能（2週間）** ✅ 完了
- [x] 感情分析（EmotionAnalyzer実装完了）
- [x] ヘルプシステム
- [x] レポート生成（月次・年次レポート実装完了）
- [ ] ランダムイベント（基本実装済、調整中）

**Sprint 5: 仕上げ（1週間）** ⬅️ 現在ここ
- [x] セキュリティ監査・依存関係整理
- [ ] 最終バグ修正
- [ ] パフォーマンス最適化
- [x] ドキュメント整備

### 📋 Phase 2: Bot版追加（将来）
- Discord/Slack Bot版の開発（約3週間）

## 🤝 コントリビューション

現在はプライベートプロジェクトとして開発中です。

## 📄 ライセンス

未定

## 🔗 リンク

- プロジェクトガイド: [CLAUDE.md](./CLAUDE.md)
- 開発環境セットアップ: [開発環境セットアップ.md](./開発環境セットアップ.md)
- 議事録索引: [議事録_INDEX.md](./議事録_INDEX.md)

---

**現在のステータス**: 🚧 Sprint 5 進行中 - 仕上げ・リリース準備フェーズ
**開始日**: 2025-11-04
**最終更新**: 2025-12-06

### 📝 最新の進捗

**2025-12-06 更新:**
- ✅ Sprint 4 までの全機能実装完了
- ✅ セキュリティ監査完了（安全な依存関係・通信設定の確認）
- ✅ レポート機能の正式実装

**主要な実装:**
- レポート生成機能（グラフ表示含む）
- キャラクター名マッピング機能
- セキュリティ強化（不要な依存関係の削除）
